local a={}local b={["'"]="&apos;",["\""]="&quot;",["<"]="&lt;",[">"]="&gt;",["&"]="&amp;"}function a.xml_escape(c)return c and c:gsub("['&<>\"]",b)or nil end;local d={lt="<",gt=">",nbsp=" ",quot="\"",apos="'",ndash="-",mdash="-",amp="&"}function a.xml_unescape(c)return c and c:gsub("&(%a+);",d)or nil end;function a.linecount(c)return select(2,c:gsub('\n','\n'))+1 end;function a.linewrap(c,e,f)c=c or""e=e or 72;f=f or 0;local g=1;return c:gsub("(%s+)()(%S+)()",function(h,i,j,k)if k-g>e then g=i;return"\n"..string.rep(" ",f)..j end end)end;function a.quote_pattern(l)local m='['..("%^$().[]*+-?"):gsub("(.)","%%%1")..']'return string.gsub(l,m,"%%%1")end;function a.query_to_pattern(n)local l=a.quote_pattern(n)l=string.gsub(l,"%a",function(o)return string.format("[%s%s]",string.lower(o),string.upper(o))end)return l end;function a.split(p,q)q=q or"\n"local r={}if a.startswith(p,q)then r[#r+1]=""end;local s=string.format("([^%s]+)",q)p:gsub(s,function(o)r[#r+1]=o end)if a.endswith(p,q)then r[#r+1]=""end;if#r==0 then r[#r+1]=p end;return r end;function a.startswith(p,t)return string.sub(p,1,string.len(t))==t end;function a.endswith(p,t)return t==""or string.sub(p,-string.len(t))==t end;return a