local a=require("my.wibox.widget.base")local b=require("my.wibox.layout.fixed")local table=table;local pairs=pairs;local c=require("my.gears.math")local d=require("my.gears.table")local e={}function e:layout(f,g,h)local i={}local j=self._private.spacing;local k=#self._private.widgets;local l=j*(k-1)local m=self._private.spacing_widget;local n=math.abs(j)local o=j<0 and 0 or j;local p=self._private.dir=="y"local q=not p;local r;if p then r=h/k-l/k else r=g/k-l/k end;if self._private.max_widget_size then r=math.min(r,self._private.max_widget_size)end;local s,t=0,0;for u,v in pairs(self._private.widgets)do local w,x,y,z;local A=s+r;local B=c.round(A)if p then w,x=0,t;y,z=g,B-t else w,x=t,0;y,z=B-t,h end;s=A+j;t=B+j;table.insert(i,a.place_widget_at(v,w,x,y,z))if u>1 and j~=0 and m then table.insert(i,a.place_widget_at(m,q and w-o or w,p and x-o or x,q and n or y,p and n or z))end end;return i end;function e:fit(C,D,E)local F=0;local G=0;local H=self._private.dir=="x"and E or E/#self._private.widgets;local I=self._private.dir=="y"and D or D/#self._private.widgets;for f,v in pairs(self._private.widgets)do local y,z=a.fit_widget(self,C,v,I,H)local J=self._private.dir=="y"and y or z;if J>G then G=J end;F=F+(self._private.dir=="y"and z or y)end;if self._private.max_widget_size then F=math.min(F,#self._private.widgets*self._private.max_widget_size)end;local j=self._private.spacing*(#self._private.widgets-1)if self._private.dir=="y"then return G,F+j end;return F+j,G end;function e:set_max_widget_size(K)if self._private.max_widget_size~=K then self._private.max_widget_size=K;self:emit_signal("widget::layout_changed")self:emit_signal("property::max_widget_size",K)end end;local function L(M,N,...)local O=b[M](N,...)d.crush(O,e,true)O._private.fill_space=nil;return O end;function e.horizontal(...)return L("horizontal",...)end;function e.vertical(...)return L("vertical",...)end;return e